graph TD
    A[ðŸ‘¤ ç”¨æˆ·ç‚¹å‡»æ”¶é›†AIæ–°é—»] --> B[ðŸ“± å‰ç«¯å‘é€POSTè¯·æ±‚]
    B --> C[ðŸ”„ åŽç«¯è·¯ç”± /api/v1/news/ai/collect]
    
    C --> D{ðŸ”’ æ£€æŸ¥æ¯æ—¥è°ƒç”¨é™åˆ¶}
    D -->|è¶…è¿‡é™åˆ¶| E[âŒ è¿”å›ž429é”™è¯¯]
    D -->|æœªè¶…è¿‡é™åˆ¶| F[ðŸŽ¯ èŽ·å–AIæ–°é—»æ”¶é›†å™¨]
    
    F --> G{ðŸ” æ”¶é›†å™¨æ˜¯å¦å­˜åœ¨?}
    G -->|ä¸å­˜åœ¨| H[âŒ è¿”å›ž404é”™è¯¯]
    G -->|å­˜åœ¨| I[ðŸ¤– è°ƒç”¨æ”¶é›†å™¨è¿è¡Œ]
    
    I --> J[ðŸŒ æž„å»ºAPIè¯·æ±‚]
    J --> K[ðŸ“ ç”ŸæˆAIæ–°é—»æç¤ºè¯]
    K --> L[ðŸ”— å‘é€HTTPè¯·æ±‚åˆ°OpenAI-HK]
    
    L --> M{ðŸ“¡ ç½‘ç»œè¿žæŽ¥çŠ¶æ€}
    M -->|è¿žæŽ¥å¤±è´¥| N[âš ï¸ è§¦å‘å¤‡ç”¨æœºåˆ¶]
    M -->|è¿žæŽ¥æˆåŠŸ| O[ðŸ“„ è§£æžAIå“åº”]
    
    N --> P[ðŸ“‹ åˆ›å»ºå¤‡ç”¨æ–°é—»é¡¹]
    P --> Q[ðŸ’¾ ä¿å­˜åˆ°æ•°æ®åº“]
    
    O --> R[ðŸ” è§£æžæ–°é—»å†…å®¹]
    R --> S[ðŸ“Š åˆ›å»ºCollectorItemå¯¹è±¡]
    S --> T{ðŸ”„ æ£€æŸ¥é‡å¤æ ‡é¢˜}
    T -->|é‡å¤| U[â­ï¸ è·³è¿‡è¯¥æ–°é—»]
    T -->|ä¸é‡å¤| V[âœ… åˆ›å»ºNewsArticle]
    
    V --> W[ðŸ’¾ ä¿å­˜åˆ°æ•°æ®åº“]
    U --> W
    Q --> W
    
    W --> X[ðŸ“ˆ æ›´æ–°APIè°ƒç”¨è®°å½•]
    X --> Y[ðŸ“¤ è¿”å›žæ”¶é›†ç»“æžœ]
    Y --> Z[ðŸ“± å‰ç«¯æ˜¾ç¤ºç»“æžœ]
    
    E --> Z
    H --> Z
    
    subgraph "ðŸ—ï¸ æ•°æ®åº“å±‚"
        DB1[(ðŸ“° NewsArticle)]
        DB2[(ðŸ“Š APICallRecord)]
        DB3[(ðŸ“‘ Category)]
    end
    
    subgraph "ðŸ”§ æ”¶é›†å™¨ç³»ç»Ÿ"
        CM[ðŸ“¦ CollectorManager]
        AC[ðŸ¤– AINewsCollector]
        BC[ðŸ“‹ BaseCollector]
        
        AC --> BC
        CM --> AC
    end
    
    subgraph "ðŸŒ å¤–éƒ¨API"
        API[ðŸ”— api.openai-hk.com]
        MODEL[ðŸ§  grok-3-deepsearch]
        
        API --> MODEL
    end
    
    subgraph "âš™ï¸ é…ç½®å±‚"
        CFG[ðŸ”§ config.py]
        ENV[ðŸŒ çŽ¯å¢ƒå˜é‡]
        
        CFG --> ENV
    end
    
    W --> DB1
    X --> DB2
    I --> CM
    L --> API
    J --> CFG
    
    style A fill:#e1f5fe
    style Z fill:#e8f5e8
    style N fill:#fff3e0
    style E fill:#ffebee
    style H fill:#ffebee
    style API fill:#f3e5f5
    style MODEL fill:#e8eaf6